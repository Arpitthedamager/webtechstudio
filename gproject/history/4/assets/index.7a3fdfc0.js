import{i as we,w as I,o as oe,a as ie,u as W,r as b,b as E,p as ae,c as ke,d as le,e as re,f as P,g as x,h as C,j as l,n as G,z as _e,F as xe,k as X,l as k,m as _,q as B,s as j,t as z,v as q,x as H,y as F,A as K,B as J,C as Z,D as Q,E as Me,G as A,H as S,I as Ce,J as Le,K as Se}from"./vendor.ee46a0b1.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function s(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(a){if(a.ep)return;a.ep=!0;const n=s(a);fetch(a.href,n)}})();function V(i,e,s){const o=()=>{var a;(a=W(i))==null||a.addEventListener(e,s)};we(i)&&I(i,o),oe(o),ie(()=>{var a;(a=W(i))==null||a.removeEventListener(e,s)})}function Ie(i,e){V(i,"wheel",s=>{if(s.preventDefault(),s.ctrlKey){const o=e.scale-s.deltaY/100;e.scale=o}else e.x-=s.deltaX,e.y-=s.deltaY})}function Oe(i,e,s){V(i,"mousedown",()=>s.value=!0),V(window,"mouseup",()=>s.value=!1),V(window,"mousemove",o=>{s.value&&(o.preventDefault(),e.x+=o.movementX,e.y+=o.movementY)})}function Fe(i){const e=a=>a&&{width:a.clientWidth,height:a.clientHeight},s=b(e(i.value)),o=new ResizeObserver(()=>{s.value=e(i.value)});return I(i,()=>{i.value&&o.observe(i.value)}),oe(()=>{i.value&&o.observe(i.value)}),ie(()=>{i.value&&o.unobserve(i.value)}),s}function ue(i){return new Promise(e=>{const s=new Image;return s.onload=()=>e(s),s.src=`data:image/svg+xml;base64,${E.Buffer.from(i).toString("base64")}`,s})}async function $e(i){return new TextEncoder().encode(i)}async function T(i,e){const s=await ue(i),{width:o,height:a}=Ne(i),n=document.createElement("canvas");n.width=o*100,n.height=a*100;const d=n.getContext("2d");e&&(d.fillStyle=e,d.fillRect(0,0,n.width,n.height)),d.drawImage(s,0,0,n.width,n.height);const m=await fetch(n.toDataURL("image/png"));return new Uint8Array(await m.arrayBuffer())}function Ne(i){const e=i.match(/<svg [^>]*width="([^"]+)mm"\sheight="([^"]+)mm"[^>]*>/);return{width:parseFloat((e==null?void 0:e[1])||"0"),height:parseFloat((e==null?void 0:e[2])||"0")}}function ze(i,e,s=0){const o=e.width/e.height,a={width:i.width-s*2,height:i.height-s*2},n={width:a.width,height:a.width/o},d={width:o*a.height,height:a.height};return n.height<=a.height?n:d}function ee(i){return{x:i.width/2,y:i.height/2}}function te(i,e){return Math.min(e,Math.max(-e,i))}const Ee=ae(ke);async function Be(i){const e=await i.arrayBuffer(),s=await Ee(new Uint8Array(e)),o=await De(s),a=Ae(o);return{layers:o,dimensions:a}}function Ae(i){let e=1/0,s=1/0,o=-1/0,a=-1/0,n="mm";for(const g of i){const r=g.gerber.toString(),c=r.split(`
`);r.includes("%MOIN*%")&&(n="in");for(const v of c){if(v.startsWith("G04")||v.startsWith("%"))continue;const h=v.match(/X([-+]?\d+)Y([-+]?\d+)/);if(h){const w=parseInt(h[1],10),y=parseInt(h[2],10);e=Math.min(e,w),s=Math.min(s,y),o=Math.max(o,w),a=Math.max(a,y)}}}const d=n==="mm"?.01:.001,m=(o-e)*d,p=(a-s)*d;return{width:Math.round(m*100)/100,height:Math.round(p*100)/100,unit:n}}async function De(i){const e=[];for(const s of Object.keys(i)){const{type:o,side:a}=Ue(s);e.push({type:o,side:a,gerber:E.Buffer.from(i[s]),filename:s})}return e}function Ue(i){let e=null,s=null;const o=i.toLowerCase().split(/_|-|\./);switch(o[o.length-1]){case"gtl":return{type:"copper",side:"top"};case"gto":return{type:"silkscreen",side:"top"};case"gtp":return{type:"solderpaste",side:"top"};case"gts":return{type:"soldermask",side:"top"};case"gbl":return{type:"copper",side:"bottom"};case"gbo":return{type:"silkscreen",side:"bottom"};case"gbp":return{type:"solderpaste",side:"bottom"};case"gbs":return{type:"soldermask",side:"bottom"};case"gko":return{type:"outline",side:"all"};case"drl":return{type:"drill",side:"all"}}return o.find(n=>n.includes("edge"))||o.find(n=>n.includes("outline"))?{type:"outline",side:"all"}:(o.includes("sm")||o.find(n=>n.includes("mask"))?e="soldermask":o.includes("sp")||o.find(n=>n.includes("paste"))?e="solderpaste":o.includes("ss")||o.find(n=>n.includes("silk"))?e="silkscreen":o.includes("cu")&&(e="copper"),o.find(n=>n.startsWith("in"))?s="inner":o.includes("f")||o.find(n=>n.includes("top"))?s="top":(o.includes("b")||o.find(n=>n.includes("bottom")))&&(s="bottom"),s=="inner"&&!e&&(e="copper"),{type:e,side:s})}const ce={green:["#004200bf","#ffffff"],red:["#b20000bf","#ffffff"],yellow:["#ff9900bf","#ffffff"],blue:["#004284bf","#ffffff"],white:["#ffffffbf","#000000"],black:["#000000bf","#ffffff"],purple:["#480084bf","#ffffff"]},Ve={gold:"#cc9933",tin:"#f5f5f5"},Ge="#999999";async function de(i,e){const[s,o]=ce[e.sm],a=e.sp?Ge:"transparent",n=Ve[e.cf];return await le(i,{color:{sm:s,ss:o,sp:a,cf:n}})}const Ye=re({__name:"GerberView",props:{layers:{},render:{}},setup(i){const e=i,s=b(),o=b(!1);async function a(){var r;if(!o.value){o.value=!0;try{if(!e.layers.length)return;const c=await de(e.layers,e.render);if(!((r=c[e.render.side])!=null&&r.svg))return;s.value=await ue(c[e.render.side].svg)}catch(c){console.error("Error rendering stack:",c)}finally{o.value=!1}}}I(()=>e.layers,async()=>{await a()},{deep:!0,immediate:!0}),I(()=>e.render,async()=>{await a()},{deep:!0,immediate:!0});const n=b(),d=b(),m=Fe(n),p=P({x:0,y:0,scale:0}),g=b(!1);return I([s,m,p],()=>{const r=d.value;!r||!m.value||requestAnimationFrame(()=>{if(r.width=m.value.width,r.height=m.value.height,!s.value||!s.value.width||!s.value.height)return;const c=r.getContext("2d");if(!c)return;c.clearRect(0,0,r.width,r.height);const v=ze(r,s.value),h=ee(r),w=ee(v);p.scale=Math.min(5,Math.max(-2,p.scale));const y=Math.pow(2,p.scale);p.x=te(p.x,h.x+w.x*y-50),p.y=te(p.y,h.y+w.y*y-50),c.save(),c.translate(h.x,h.y),c.translate(p.x,p.y),c.scale(y,y),c.translate(-w.x,-w.y),c.drawImage(s.value,0,0,v.width,v.height),c.restore()})},{immediate:!0}),I(s,()=>{p.scale=0,p.x=0,p.y=0}),Ie(d,p),Oe(d,p,g),(r,c)=>(x(),C("div",{ref:v=>n.value=v,class:G(r.$style.container)},[l("canvas",{ref:v=>d.value=v,class:G({[r.$style.dragging]:g.value})},null,2)],2))}}),Xe="_container_1vsww_1",Te="_dragging_1vsww_9",We={container:Xe,dragging:Te},fe=(i,e)=>{const s=i.__vccOpts||i;for(const[o,a]of e)s[o]=a;return s},Pe={$style:We},se=fe(Ye,[["__cssModules",Pe]]);function Re(i){let e=1/0,s=-1/0,o=1/0,a=-1/0,n="mm";const d=i.match(/%FSLAX(\d)(\d)Y(\d)(\d)\*%/);d&&`${d[1]}${d[2]}`,(i.includes("%MOIN*%")||i.includes("%MO IN*%"))&&(n="in");const m=/X(-?\d+)Y(-?\d+)/g;let p;for(;(p=m.exec(i))!==null;){const h=parseFloat(p[1])/Math.pow(10,6),w=parseFloat(p[2])/Math.pow(10,6);e=Math.min(e,h),s=Math.max(s,h),o=Math.min(o,w),a=Math.max(a,w)}let g=Math.round((s-e)*100)/100,r=Math.round((a-o)*100)/100;n==="in"&&(g=Math.round(g/25.4*100)/100,r=Math.round(r/25.4*100)/100);const c=n==="mm"?500:20,v=n==="mm"?1:.04;return g>c||r>c?(console.warn("Calculated dimensions seem too large, using default values"),{width:n==="mm"?100:4,height:n==="mm"?100:4,unit:n}):g<v||r<v?(console.warn("Calculated dimensions seem too small, using default values"),{width:n==="mm"?100:4,height:n==="mm"?100:4,unit:n}):{width:g||(n==="mm"?100:4),height:r||(n==="mm"?100:4),unit:n}}async function je(i){try{const e=await i.arrayBuffer(),s=new Uint8Array(e),o=["%FS","%MO","G04","D01","D02","D03","M02","M00","X","Y","D","*"].map(r=>E.Buffer.from(r)),a=[];let n=[],d=!1;for(let r=0;r<s.length;r++){const c=s[r];o.some(h=>h[0]===c&&s.slice(r,r+h.length).every((w,y)=>w===h[y]))&&(d&&(a.push(E.Buffer.from(n)),n=[]),d=!0),d&&n.push(c)}n.length>0&&a.push(E.Buffer.from(n));const m={};if(a.forEach((r,c)=>{const v=r.toString("utf8");if(v.trim()){const h=`layer${c+1}.gbr`;m[h]={name:h,content:ne(v)}}}),Object.keys(m).length===0){const r=new TextDecoder().decode(s);m["main.gbr"]={name:"main.gbr",content:ne(r)}}const p=Object.entries(m).map(([r,c])=>{const{type:v,side:h}=qe(r);return{type:v,side:h,gerber:E.Buffer.from(c.content),filename:r}}),g=Re(m[Object.keys(m)[0]].content);return{layers:p,dimensions:g}}catch(e){throw console.error("Error processing RAR file:",e),e}}function ne(i){let e=i;return i.includes("%FS")||(e=`%FSLAX26Y26*%
`+e),i.includes("%MO")||(e=`%MOMM*%
`+e),i.includes("M02")||(e+=`
M02*`),e}function qe(i){const e=i.toLowerCase();let s="copper",o="top";return e.includes("gtl")||e.includes("top")?o="top":(e.includes("gbl")||e.includes("bottom"))&&(o="bottom"),e.includes("gto")||e.includes("silk")?s="silkscreen":e.includes("gts")||e.includes("mask")?s="soldermask":(e.includes("drl")||e.includes("drill"))&&(s="drill"),{type:s,side:o}}const He=ae(_e);async function Ke(i,e){const s={},o={level:9};for(const n of Object.keys(i))s[n]=[i[n],o];const a=await He(s);xe.exports.saveAs(new Blob([a],{type:"application/zip"}),e)}const Je={class:"app-container"},Ze={class:"content-wrapper"},Qe={key:0,class:"card upload-card"},et={class:"upload-area"},tt={key:1,class:"loading-overlay"},st={key:2,class:"preview-section card"},nt={class:"pcb-views"},ot={class:"pcb-view"},it={class:"pcb-view"},at={key:3,class:"card main-card"},lt={class:"dimensions-section"},rt={class:"dimensions-inputs"},ut={class:"info-grid"},ct={class:"info-item"},dt={class:"info-value"},ft={class:"info-item"},pt={class:"info-value"},mt={class:"info-item"},vt={class:"info-value"},ht={class:"info-item"},yt={class:"info-value"},gt={class:"info-item"},bt={class:"color-select"},wt=["value"],kt={class:"info-item"},_t={class:"info-value"},xt={class:"output-section"},Mt={class:"format-section"},Ct={class:"format-buttons"},Lt={class:"checkbox-group"},St={class:"checkbox-label"},It={class:"checkbox-label"},Ot=["disabled"],Ft={class:"layer-settings-content"},$t={class:"layers-list"},Nt={class:"layer-name"},zt={class:"layer-controls"},Et={key:0,class:"side-buttons"},Bt={class:"modal-footer"},At=re({__name:"App",setup(i){const e=b(),s=b([]),o=b(!1),a=b(!1),n=b(0),d=b(!1),m=b("svg"),p=b(!0),g=b(!1),r=P({width:0,height:0,unit:"mm"}),c=P({side:"top",sm:"blue",cf:"gold",sp:!1}),v=X(()=>s.value.filter(f=>{var t;return(t=f.type)==null?void 0:t.includes("copper")}).length||0),h=X(()=>s.value.filter(f=>{var t;return(t=f.type)==null?void 0:t.includes("mask")}).length||0),w=X(()=>s.value.reduce((f,t)=>t.type==="copper"?f+0:f,0));function y(){n.value++}function me(){y()}function Y(f,t){f.side=t,y()}function ve(){s.value.forEach(f=>{f.type=void 0,f.side=void 0}),y()}function he(){a.value=!1,y()}function ye({file:f}){return ge(f)}async function ge(f){try{if(o.value=!0,!f||!(f instanceof File))throw new Error("Invalid file provided");let t;if(f.name.toLowerCase().endsWith(".zip"))t=await Be(f);else if(f.name.toLowerCase().endsWith(".rar"))t=await je(f);else throw new Error("Unsupported file format");t.dimensions&&(r.width=Number(t.dimensions.width),r.height=Number(t.dimensions.height),r.unit=t.dimensions.unit),e.value=f,s.value=t.layers,await Q(),d.value=!0,y()}catch(t){console.error("Error loading file:",t)}finally{o.value=!1}}async function be(){var f,t,D,O;if(!(!e.value||!s.value.length))try{const L=await de(s.value,c),M={},$=m.value,N=$==="png"?T:$e;if((f=L.top)!=null&&f.svg&&(M[`top.${$}`]=await N(L.top.svg)),(t=L.bottom)!=null&&t.svg&&(M[`bottom.${$}`]=await N(L.bottom.svg)),p.value&&L.layers){for(const u of L.layers)if(u.converter){const R=Me(u.converter,{});M[`${u.filename}.${$}`]=await N(R)}}if(g.value){const u=await le(s.value,{color:{fr4:"transparent",cu:"#ffffff",cf:"transparent",sm:"transparent",ss:"transparent",sp:"transparent",out:"transparent"}});(D=u.top)!=null&&D.svg&&(M["top-relief.png"]=await T(u.top.svg,"#000000")),(O=u.bottom)!=null&&O.svg&&(M["bottom-relief.png"]=await T(u.bottom.svg,"#000000"))}await Ke(M,`${e.value.name.replace(/\..+$/,"")}-img.zip`)}catch(L){console.error("Error generating output:",L)}}return I(()=>r.unit,f=>{if(r.width&&r.height){const t=f==="mm"?25.4:.03937007874015748;r.width=Number((Number(r.width)*t).toFixed(2)),r.height=Number((Number(r.height)*t).toFixed(2)),y()}},{immediate:!0}),I(s,()=>{s.value.length>0&&(d.value=!0,y())},{deep:!0,immediate:!0}),I(c,()=>{y()},{deep:!0,immediate:!0}),I(d,f=>{f&&Q(()=>{y()})},{immediate:!0}),(f,t)=>{var N;const D=A("a-upload"),O=A("a-select-option"),L=A("a-select"),M=A("a-button"),$=A("a-modal");return x(),C("div",Je,[l("div",Ze,[e.value?B("",!0):(x(),C("div",Qe,[t[11]||(t[11]=l("h2",{class:"section-title"},"Choose Gerber/file or drag & drop here",-1)),l("div",et,[k(D,{"custom-request":ye,"show-upload-list":!1,accept:".zip,.rar,application/zip,application/x-rar-compressed",class:"upload-container"},{default:_(()=>t[10]||(t[10]=[l("div",{class:"upload-content"},[l("div",{class:"plus-icon"},"+"),l("p",{class:"upload-text"},"File format should be"),l("p",{class:"upload-subtext"},"only accepted .zip or .rar file")],-1)])),_:1})])])),o.value?(x(),C("div",tt,t[12]||(t[12]=[l("div",{class:"loading-spinner"},null,-1),l("p",null,"Processing Gerber files...",-1)]))):B("",!0),s.value.length&&!o.value&&d.value?(x(),C("div",st,[l("div",nt,[l("div",ot,[(x(),j(se,{key:"top-"+n.value,layers:s.value,render:{...c,side:"top"},class:"pcb-canvas"},null,8,["layers","render"]))]),l("div",it,[(x(),j(se,{key:"bottom-"+n.value,layers:s.value,render:{...c,side:"bottom"},class:"pcb-canvas"},null,8,["layers","render"]))])]),l("button",{class:"layer-settings-button",onClick:t[0]||(t[0]=u=>a.value=!0)},"Layer Settings")])):B("",!0),e.value&&!o.value&&d.value?(x(),C("div",at,[l("div",lt,[t[15]||(t[15]=l("label",{class:"section-title"},"Dimensions",-1)),l("div",rt,[z(l("input",{"onUpdate:modelValue":t[1]||(t[1]=u=>r.width=u),type:"text",placeholder:"Width",class:"dimension-input"},null,512),[[q,r.width]]),t[14]||(t[14]=l("span",{class:"dimension-separator"},"x",-1)),z(l("input",{"onUpdate:modelValue":t[2]||(t[2]=u=>r.height=u),type:"text",placeholder:"Height",class:"dimension-input"},null,512),[[q,r.height]]),z(l("select",{"onUpdate:modelValue":t[3]||(t[3]=u=>r.unit=u),class:"dimension-select"},t[13]||(t[13]=[l("option",{value:"mm"},"mm",-1),l("option",{value:"in"},"in",-1)]),512),[[H,r.unit]])])]),l("div",ut,[l("div",ct,[t[16]||(t[16]=l("label",{class:"info-label"},"File Name",-1)),l("span",dt,F(((N=e.value)==null?void 0:N.name)||"-"),1)]),l("div",ft,[t[17]||(t[17]=l("label",{class:"info-label"},"Total Layers",-1)),l("span",pt,F(s.value.length||"-"),1)]),l("div",mt,[t[18]||(t[18]=l("label",{class:"info-label"},"Copper Layers",-1)),l("span",vt,F(v.value),1)]),l("div",ht,[t[19]||(t[19]=l("label",{class:"info-label"},"Mask Layers",-1)),l("span",yt,F(h.value),1)]),l("div",gt,[t[20]||(t[20]=l("label",{class:"info-label"},"Mask Color",-1)),l("div",bt,[z(l("select",{"onUpdate:modelValue":t[4]||(t[4]=u=>c.sm=u),class:"color-dropdown"},[(x(!0),C(K,null,J(Object.keys(W(ce)),u=>(x(),C("option",{key:u,value:u},F(u.charAt(0).toUpperCase()+u.slice(1)),9,wt))),128))],512),[[H,c.sm]])])]),l("div",kt,[t[21]||(t[21]=l("label",{class:"info-label"},"Number of Pads",-1)),l("span",_t,F(w.value),1)])]),l("div",xt,[t[25]||(t[25]=l("label",{class:"section-title"},"Output :",-1)),l("div",Mt,[t[22]||(t[22]=l("label",{class:"format-label"},"Format",-1)),l("div",Ct,[l("button",{class:G(["format-button",{active:m.value==="svg"}]),onClick:t[5]||(t[5]=u=>m.value="svg")},"SVG",2),l("button",{class:G(["format-button",{active:m.value==="png"}]),onClick:t[6]||(t[6]=u=>m.value="png")},"PNG",2)])]),l("div",Lt,[l("label",St,[z(l("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=u=>p.value=u),class:"checkbox-input"},null,512),[[Z,p.value]]),t[23]||(t[23]=l("span",null,"Output Layered files",-1))]),l("label",It,[z(l("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=u=>g.value=u),class:"checkbox-input"},null,512),[[Z,g.value]]),t[24]||(t[24]=l("span",null,"Export relief texture",-1))])])]),l("button",{class:"output-button",onClick:be,disabled:!e.value||!s.value.length}," Output File ",8,Ot)])):B("",!0)]),k($,{visible:a.value,"onUpdate:visible":t[9]||(t[9]=u=>a.value=u),title:"Layer Settings",width:"800px",class:"layer-settings-modal",footer:null},{default:_(()=>[l("div",Ft,[l("div",$t,[(x(!0),C(K,null,J(s.value,(u,R)=>(x(),C("div",{key:u.filename,class:"layer-item"},[l("div",Nt,F(u.filename),1),l("div",zt,[k(L,{value:u.type,"onUpdate:value":U=>u.type=U,style:{width:"120px"},onChange:me},{default:_(()=>[k(O,{value:"drill"},{default:_(()=>t[26]||(t[26]=[S("Drill")])),_:1}),k(O,{value:"copper"},{default:_(()=>t[27]||(t[27]=[S("Copper")])),_:1}),k(O,{value:"silkscreen"},{default:_(()=>t[28]||(t[28]=[S("Silkscreen")])),_:1}),k(O,{value:"soldermask"},{default:_(()=>t[29]||(t[29]=[S("Soldermask")])),_:1}),k(O,{value:"ignore"},{default:_(()=>t[30]||(t[30]=[S("Ignore")])),_:1})]),_:2},1032,["value","onUpdate:value"]),u.type==="copper"||u.type==="soldermask"||u.type==="silkscreen"?(x(),C("div",Et,[k(M,{type:u.side==="top"?"primary":"default",size:"small",onClick:U=>Y(u,"top")},{default:_(()=>t[31]||(t[31]=[S(" Top ")])),_:2},1032,["type","onClick"]),k(M,{type:u.side==="bottom"?"primary":"default",size:"small",onClick:U=>Y(u,"bottom")},{default:_(()=>t[32]||(t[32]=[S(" Bottom ")])),_:2},1032,["type","onClick"]),k(M,{type:u.side==="inner"?"primary":"default",size:"small",onClick:U=>Y(u,"inner")},{default:_(()=>t[33]||(t[33]=[S(" Inner ")])),_:2},1032,["type","onClick"])])):B("",!0)])]))),128))]),l("div",Bt,[k(M,{onClick:ve},{default:_(()=>t[34]||(t[34]=[S("Restore Default")])),_:1}),k(M,{type:"primary",onClick:he},{default:_(()=>t[35]||(t[35]=[S("Apply")])),_:1})])])]),_:1},8,["visible"])])}}});const Dt=fe(At,[["__scopeId","data-v-b2e0cc06"]]);window.process=Ce.exports;const pe=Le(Dt);pe.use(Se);pe.mount("#app");
