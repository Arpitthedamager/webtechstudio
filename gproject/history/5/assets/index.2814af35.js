import{i as we,w as I,o as ie,a as ae,u as P,r as w,b as E,p as le,c as ke,d as re,e as ue,f as R,g as x,h as C,j as l,n as X,z as _e,F as xe,k as T,l as k,m as _,q as A,s as q,t as D,v as H,x as K,y as $,A as J,B as Z,C as Q,D as ee,E as Me,G as B,H as S,I as Ce,J as Le,K as Se}from"./vendor.ee46a0b1.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function s(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(a){if(a.ep)return;a.ep=!0;const n=s(a);fetch(a.href,n)}})();function Y(i,e,s){const o=()=>{var a;(a=P(i))==null||a.addEventListener(e,s)};we(i)&&I(i,o),ie(o),ae(()=>{var a;(a=P(i))==null||a.removeEventListener(e,s)})}function Ie(i,e){Y(i,"wheel",s=>{if(s.preventDefault(),s.ctrlKey){const o=e.scale-s.deltaY/100;e.scale=o}else e.x-=s.deltaX,e.y-=s.deltaY})}function Fe(i,e,s){Y(i,"mousedown",()=>s.value=!0),Y(window,"mouseup",()=>s.value=!1),Y(window,"mousemove",o=>{s.value&&(o.preventDefault(),e.x+=o.movementX,e.y+=o.movementY)})}function $e(i){const e=a=>a&&{width:a.clientWidth,height:a.clientHeight},s=w(e(i.value)),o=new ResizeObserver(()=>{s.value=e(i.value)});return I(i,()=>{i.value&&o.observe(i.value)}),ie(()=>{i.value&&o.observe(i.value)}),ae(()=>{i.value&&o.unobserve(i.value)}),s}function ce(i){return new Promise(e=>{const s=new Image;return s.onload=()=>e(s),s.src=`data:image/svg+xml;base64,${E.Buffer.from(i).toString("base64")}`,s})}async function Oe(i){return new TextEncoder().encode(i)}async function W(i,e){const s=await ce(i),{width:o,height:a}=Ne(i),n=document.createElement("canvas");n.width=o*100,n.height=a*100;const d=n.getContext("2d");e&&(d.fillStyle=e,d.fillRect(0,0,n.width,n.height)),d.drawImage(s,0,0,n.width,n.height);const m=await fetch(n.toDataURL("image/png"));return new Uint8Array(await m.arrayBuffer())}function Ne(i){const e=i.match(/<svg [^>]*width="([^"]+)mm"\sheight="([^"]+)mm"[^>]*>/);return{width:parseFloat((e==null?void 0:e[1])||"0"),height:parseFloat((e==null?void 0:e[2])||"0")}}function ze(i,e,s=0){const o=e.width/e.height,a={width:i.width-s*2,height:i.height-s*2},n={width:a.width,height:a.width/o},d={width:o*a.height,height:a.height};return n.height<=a.height?n:d}function te(i){return{x:i.width/2,y:i.height/2}}function se(i,e){return Math.min(e,Math.max(-e,i))}const De=le(ke);async function Ee(i){const e=await i.arrayBuffer(),s=await De(new Uint8Array(e)),o=await Be(s),a=Ae(o);return{layers:o,dimensions:a}}function Ae(i){let e=1/0,s=1/0,o=-1/0,a=-1/0,n="mm";for(const r of i){const c=r.gerber.toString(),h=c.split(`
`);c.includes("%MOIN*%")&&(n="in");const v=c.match(/%FSLAX(\d)(\d)Y(\d)(\d)\*%/);v&&`${v[1]}${v[2]}`;for(const b of h){if(b.startsWith("G04")||b.startsWith("%"))continue;const g=b.match(/X([-+]?\d+)Y([-+]?\d+)/);if(g){const U=parseFloat(g[1])/Math.pow(10,6),O=parseFloat(g[2])/Math.pow(10,6);e=Math.min(e,U),s=Math.min(s,O),o=Math.max(o,U),a=Math.max(a,O)}}}let d=Math.round((o-e)*100)/100,m=Math.round((a-s)*100)/100;n==="in"&&(d=Math.round(d/25.4*100)/100,m=Math.round(m/25.4*100)/100);const p=n==="mm"?500:20,y=n==="mm"?1:.04;return d>p||m>p?(console.warn("Calculated dimensions seem too large, using default values"),{width:n==="mm"?100:4,height:n==="mm"?100:4,unit:n}):d<y||m<y?(console.warn("Calculated dimensions seem too small, using default values"),{width:n==="mm"?100:4,height:n==="mm"?100:4,unit:n}):{width:d||(n==="mm"?100:4),height:m||(n==="mm"?100:4),unit:n}}async function Be(i){const e=[];for(const s of Object.keys(i)){const{type:o,side:a}=Ue(s);e.push({type:o,side:a,gerber:E.Buffer.from(i[s]),filename:s})}return e}function Ue(i){let e=null,s=null;const o=i.toLowerCase().split(/_|-|\./);switch(o[o.length-1]){case"gtl":return{type:"copper",side:"top"};case"gto":return{type:"silkscreen",side:"top"};case"gtp":return{type:"solderpaste",side:"top"};case"gts":return{type:"soldermask",side:"top"};case"gbl":return{type:"copper",side:"bottom"};case"gbo":return{type:"silkscreen",side:"bottom"};case"gbp":return{type:"solderpaste",side:"bottom"};case"gbs":return{type:"soldermask",side:"bottom"};case"gko":return{type:"outline",side:"all"};case"drl":return{type:"drill",side:"all"}}return o.find(n=>n.includes("edge"))||o.find(n=>n.includes("outline"))?{type:"outline",side:"all"}:(o.includes("sm")||o.find(n=>n.includes("mask"))?e="soldermask":o.includes("sp")||o.find(n=>n.includes("paste"))?e="solderpaste":o.includes("ss")||o.find(n=>n.includes("silk"))?e="silkscreen":o.includes("cu")&&(e="copper"),o.find(n=>n.startsWith("in"))?s="inner":o.includes("f")||o.find(n=>n.includes("top"))?s="top":(o.includes("b")||o.find(n=>n.includes("bottom")))&&(s="bottom"),s=="inner"&&!e&&(e="copper"),{type:e,side:s})}const de={green:["#004200bf","#ffffff"],red:["#b20000bf","#ffffff"],yellow:["#ff9900bf","#ffffff"],blue:["#004284bf","#ffffff"],white:["#ffffffbf","#000000"],black:["#000000bf","#ffffff"],purple:["#480084bf","#ffffff"]},Ve={gold:"#cc9933",tin:"#f5f5f5"},Ge="#999999";async function fe(i,e){const[s,o]=de[e.sm],a=e.sp?Ge:"transparent",n=Ve[e.cf];return await re(i,{color:{sm:s,ss:o,sp:a,cf:n}})}const Ye=ue({__name:"GerberView",props:{layers:{},render:{}},setup(i){const e=i,s=w(),o=w(!1);async function a(){var r;if(!o.value){o.value=!0;try{if(!e.layers.length)return;const c=await fe(e.layers,e.render);if(!((r=c[e.render.side])!=null&&r.svg))return;s.value=await ce(c[e.render.side].svg)}catch(c){console.error("Error rendering stack:",c)}finally{o.value=!1}}}I(()=>e.layers,async()=>{await a()},{deep:!0,immediate:!0}),I(()=>e.render,async()=>{await a()},{deep:!0,immediate:!0});const n=w(),d=w(),m=$e(n),p=R({x:0,y:0,scale:0}),y=w(!1);return I([s,m,p],()=>{const r=d.value;!r||!m.value||requestAnimationFrame(()=>{if(r.width=m.value.width,r.height=m.value.height,!s.value||!s.value.width||!s.value.height)return;const c=r.getContext("2d");if(!c)return;c.clearRect(0,0,r.width,r.height);const h=ze(r,s.value),v=te(r),b=te(h);p.scale=Math.min(5,Math.max(-2,p.scale));const g=Math.pow(2,p.scale);p.x=se(p.x,v.x+b.x*g-50),p.y=se(p.y,v.y+b.y*g-50),c.save(),c.translate(v.x,v.y),c.translate(p.x,p.y),c.scale(g,g),c.translate(-b.x,-b.y),c.drawImage(s.value,0,0,h.width,h.height),c.restore()})},{immediate:!0}),I(s,()=>{p.scale=0,p.x=0,p.y=0}),Ie(d,p),Fe(d,p,y),(r,c)=>(x(),C("div",{ref:h=>n.value=h,class:X(r.$style.container)},[l("canvas",{ref:h=>d.value=h,class:X({[r.$style.dragging]:y.value})},null,2)],2))}}),Xe="_container_1vsww_1",Te="_dragging_1vsww_9",We={container:Xe,dragging:Te},pe=(i,e)=>{const s=i.__vccOpts||i;for(const[o,a]of e)s[o]=a;return s},Pe={$style:We},ne=pe(Ye,[["__cssModules",Pe]]);function Re(i){let e=1/0,s=-1/0,o=1/0,a=-1/0,n="mm";const d=i.match(/%FSLAX(\d)(\d)Y(\d)(\d)\*%/);d&&`${d[1]}${d[2]}`,(i.includes("%MOIN*%")||i.includes("%MO IN*%"))&&(n="in");const m=/X(-?\d+)Y(-?\d+)/g;let p;for(;(p=m.exec(i))!==null;){const v=parseFloat(p[1])/Math.pow(10,6),b=parseFloat(p[2])/Math.pow(10,6);e=Math.min(e,v),s=Math.max(s,v),o=Math.min(o,b),a=Math.max(a,b)}let y=Math.round((s-e)*100)/100,r=Math.round((a-o)*100)/100;n==="in"&&(y=Math.round(y/25.4*100)/100,r=Math.round(r/25.4*100)/100);const c=n==="mm"?500:20,h=n==="mm"?1:.04;return y>c||r>c?(console.warn("Calculated dimensions seem too large, using default values"),{width:n==="mm"?100:4,height:n==="mm"?100:4,unit:n}):y<h||r<h?(console.warn("Calculated dimensions seem too small, using default values"),{width:n==="mm"?100:4,height:n==="mm"?100:4,unit:n}):{width:y||(n==="mm"?100:4),height:r||(n==="mm"?100:4),unit:n}}async function je(i){try{const e=await i.arrayBuffer(),s=new Uint8Array(e),o=["%FS","%MO","G04","D01","D02","D03","M02","M00","X","Y","D","*"].map(r=>E.Buffer.from(r)),a=[];let n=[],d=!1;for(let r=0;r<s.length;r++){const c=s[r];o.some(v=>v[0]===c&&s.slice(r,r+v.length).every((b,g)=>b===v[g]))&&(d&&(a.push(E.Buffer.from(n)),n=[]),d=!0),d&&n.push(c)}n.length>0&&a.push(E.Buffer.from(n));const m={};if(a.forEach((r,c)=>{const h=r.toString("utf8");if(h.trim()){const v=`layer${c+1}.gbr`;m[v]={name:v,content:oe(h)}}}),Object.keys(m).length===0){const r=new TextDecoder().decode(s);m["main.gbr"]={name:"main.gbr",content:oe(r)}}const p=Object.entries(m).map(([r,c])=>{const{type:h,side:v}=qe(r);return{type:h,side:v,gerber:E.Buffer.from(c.content),filename:r}}),y=Re(m[Object.keys(m)[0]].content);return{layers:p,dimensions:y}}catch(e){throw console.error("Error processing RAR file:",e),e}}function oe(i){let e=i;return i.includes("%FS")||(e=`%FSLAX26Y26*%
`+e),i.includes("%MO")||(e=`%MOMM*%
`+e),i.includes("M02")||(e+=`
M02*`),e}function qe(i){const e=i.toLowerCase();let s="copper",o="top";return e.includes("gtl")||e.includes("top")?o="top":(e.includes("gbl")||e.includes("bottom"))&&(o="bottom"),e.includes("gto")||e.includes("silk")?s="silkscreen":e.includes("gts")||e.includes("mask")?s="soldermask":(e.includes("drl")||e.includes("drill"))&&(s="drill"),{type:s,side:o}}const He=le(_e);async function Ke(i,e){const s={},o={level:9};for(const n of Object.keys(i))s[n]=[i[n],o];const a=await He(s);xe.exports.saveAs(new Blob([a],{type:"application/zip"}),e)}const Je={class:"app-container"},Ze={class:"content-wrapper"},Qe={key:0,class:"card upload-card"},et={class:"upload-area"},tt={key:1,class:"loading-overlay"},st={key:2,class:"preview-section card"},nt={class:"pcb-views"},ot={class:"pcb-view"},it={class:"pcb-view"},at={key:3,class:"card main-card"},lt={class:"dimensions-section"},rt={class:"dimensions-inputs"},ut={class:"info-grid"},ct={class:"info-item"},dt={class:"info-value"},ft={class:"info-item"},pt={class:"info-value"},mt={class:"info-item"},vt={class:"info-value"},ht={class:"info-item"},gt={class:"info-value"},yt={class:"info-item"},bt={class:"color-select"},wt=["value"],kt={class:"info-item"},_t={class:"info-value"},xt={class:"output-section"},Mt={class:"format-section"},Ct={class:"format-buttons"},Lt={class:"checkbox-group"},St={class:"checkbox-label"},It={class:"checkbox-label"},Ft=["disabled"],$t={class:"layer-settings-content"},Ot={class:"layers-list"},Nt={class:"layer-name"},zt={class:"layer-controls"},Dt={key:0,class:"side-buttons"},Et={class:"modal-footer"},At=ue({__name:"App",setup(i){const e=w(),s=w([]),o=w(!1),a=w(!1),n=w(0),d=w(!1),m=w("svg"),p=w(!0),y=w(!1),r=R({width:0,height:0,unit:"mm"}),c=R({side:"top",sm:"blue",cf:"gold",sp:!1}),h=T(()=>s.value.filter(f=>{var t;return(t=f.type)==null?void 0:t.includes("copper")}).length||0),v=T(()=>s.value.filter(f=>{var t;return(t=f.type)==null?void 0:t.includes("mask")}).length||0),b=T(()=>s.value.reduce((f,t)=>t.type==="copper"?f+0:f,0));function g(){n.value++}function U(){g()}function O(f,t){f.side=t,g()}function ve(){s.value.forEach(f=>{f.type=void 0,f.side=void 0}),g()}function he(){a.value=!1,g()}function ge({file:f}){return ye(f)}async function ye(f){try{if(o.value=!0,!f||!(f instanceof File))throw new Error("Invalid file provided");let t;if(f.name.toLowerCase().endsWith(".zip"))t=await Ee(f);else if(f.name.toLowerCase().endsWith(".rar"))t=await je(f);else throw new Error("Unsupported file format");t.dimensions&&(r.width=Number(t.dimensions.width),r.height=Number(t.dimensions.height),r.unit=t.dimensions.unit),e.value=f,s.value=t.layers,await ee(),d.value=!0,g()}catch(t){console.error("Error loading file:",t)}finally{o.value=!1}}async function be(){var f,t,V,F;if(!(!e.value||!s.value.length))try{const L=await fe(s.value,c),M={},N=m.value,z=N==="png"?W:Oe;if((f=L.top)!=null&&f.svg&&(M[`top.${N}`]=await z(L.top.svg)),(t=L.bottom)!=null&&t.svg&&(M[`bottom.${N}`]=await z(L.bottom.svg)),p.value&&L.layers){for(const u of L.layers)if(u.converter){const j=Me(u.converter,{});M[`${u.filename}.${N}`]=await z(j)}}if(y.value){const u=await re(s.value,{color:{fr4:"transparent",cu:"#ffffff",cf:"transparent",sm:"transparent",ss:"transparent",sp:"transparent",out:"transparent"}});(V=u.top)!=null&&V.svg&&(M["top-relief.png"]=await W(u.top.svg,"#000000")),(F=u.bottom)!=null&&F.svg&&(M["bottom-relief.png"]=await W(u.bottom.svg,"#000000"))}await Ke(M,`${e.value.name.replace(/\..+$/,"")}-img.zip`)}catch(L){console.error("Error generating output:",L)}}return I(()=>r.unit,f=>{if(r.width&&r.height){const t=f==="mm"?25.4:.03937007874015748;r.width=Number((Number(r.width)*t).toFixed(2)),r.height=Number((Number(r.height)*t).toFixed(2)),g()}},{immediate:!0}),I(s,()=>{s.value.length>0&&(d.value=!0,g())},{deep:!0,immediate:!0}),I(c,()=>{g()},{deep:!0,immediate:!0}),I(d,f=>{f&&ee(()=>{g()})},{immediate:!0}),(f,t)=>{var z;const V=B("a-upload"),F=B("a-select-option"),L=B("a-select"),M=B("a-button"),N=B("a-modal");return x(),C("div",Je,[l("div",Ze,[e.value?A("",!0):(x(),C("div",Qe,[t[11]||(t[11]=l("h2",{class:"section-title"},"Choose Gerber/file or drag & drop here",-1)),l("div",et,[k(V,{"custom-request":ge,"show-upload-list":!1,accept:".zip,.rar,application/zip,application/x-rar-compressed",class:"upload-container"},{default:_(()=>t[10]||(t[10]=[l("div",{class:"upload-content"},[l("div",{class:"plus-icon"},"+"),l("p",{class:"upload-text"},"File format should be"),l("p",{class:"upload-subtext"},"only accepted .zip or .rar file")],-1)])),_:1})])])),o.value?(x(),C("div",tt,t[12]||(t[12]=[l("div",{class:"loading-spinner"},null,-1),l("p",null,"Processing Gerber files...",-1)]))):A("",!0),s.value.length&&!o.value&&d.value?(x(),C("div",st,[l("div",nt,[l("div",ot,[(x(),q(ne,{key:"top-"+n.value,layers:s.value,render:{...c,side:"top"},class:"pcb-canvas"},null,8,["layers","render"]))]),l("div",it,[(x(),q(ne,{key:"bottom-"+n.value,layers:s.value,render:{...c,side:"bottom"},class:"pcb-canvas"},null,8,["layers","render"]))])]),l("button",{class:"layer-settings-button",onClick:t[0]||(t[0]=u=>a.value=!0)},"Layer Settings")])):A("",!0),e.value&&!o.value&&d.value?(x(),C("div",at,[l("div",lt,[t[15]||(t[15]=l("label",{class:"section-title"},"Dimensions",-1)),l("div",rt,[D(l("input",{"onUpdate:modelValue":t[1]||(t[1]=u=>r.width=u),type:"text",placeholder:"Width",class:"dimension-input"},null,512),[[H,r.width]]),t[14]||(t[14]=l("span",{class:"dimension-separator"},"x",-1)),D(l("input",{"onUpdate:modelValue":t[2]||(t[2]=u=>r.height=u),type:"text",placeholder:"Height",class:"dimension-input"},null,512),[[H,r.height]]),D(l("select",{"onUpdate:modelValue":t[3]||(t[3]=u=>r.unit=u),class:"dimension-select"},t[13]||(t[13]=[l("option",{value:"mm"},"mm",-1),l("option",{value:"in"},"in",-1)]),512),[[K,r.unit]])])]),l("div",ut,[l("div",ct,[t[16]||(t[16]=l("label",{class:"info-label"},"File Name",-1)),l("span",dt,$(((z=e.value)==null?void 0:z.name)||"-"),1)]),l("div",ft,[t[17]||(t[17]=l("label",{class:"info-label"},"Total Layers",-1)),l("span",pt,$(s.value.length||"-"),1)]),l("div",mt,[t[18]||(t[18]=l("label",{class:"info-label"},"Copper Layers",-1)),l("span",vt,$(h.value),1)]),l("div",ht,[t[19]||(t[19]=l("label",{class:"info-label"},"Mask Layers",-1)),l("span",gt,$(v.value),1)]),l("div",yt,[t[20]||(t[20]=l("label",{class:"info-label"},"Mask Color",-1)),l("div",bt,[D(l("select",{"onUpdate:modelValue":t[4]||(t[4]=u=>c.sm=u),class:"color-dropdown"},[(x(!0),C(J,null,Z(Object.keys(P(de)),u=>(x(),C("option",{key:u,value:u},$(u.charAt(0).toUpperCase()+u.slice(1)),9,wt))),128))],512),[[K,c.sm]])])]),l("div",kt,[t[21]||(t[21]=l("label",{class:"info-label"},"Number of Pads",-1)),l("span",_t,$(b.value),1)])]),l("div",xt,[t[25]||(t[25]=l("label",{class:"section-title"},"Output :",-1)),l("div",Mt,[t[22]||(t[22]=l("label",{class:"format-label"},"Format",-1)),l("div",Ct,[l("button",{class:X(["format-button",{active:m.value==="svg"}]),onClick:t[5]||(t[5]=u=>m.value="svg")},"SVG",2),l("button",{class:X(["format-button",{active:m.value==="png"}]),onClick:t[6]||(t[6]=u=>m.value="png")},"PNG",2)])]),l("div",Lt,[l("label",St,[D(l("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=u=>p.value=u),class:"checkbox-input"},null,512),[[Q,p.value]]),t[23]||(t[23]=l("span",null,"Output Layered files",-1))]),l("label",It,[D(l("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=u=>y.value=u),class:"checkbox-input"},null,512),[[Q,y.value]]),t[24]||(t[24]=l("span",null,"Export relief texture",-1))])])]),l("button",{class:"output-button",onClick:be,disabled:!e.value||!s.value.length}," Output File ",8,Ft)])):A("",!0)]),k(N,{visible:a.value,"onUpdate:visible":t[9]||(t[9]=u=>a.value=u),title:"Layer Settings",width:"800px",class:"layer-settings-modal",footer:null},{default:_(()=>[l("div",$t,[l("div",Ot,[(x(!0),C(J,null,Z(s.value,(u,j)=>(x(),C("div",{key:u.filename,class:"layer-item"},[l("div",Nt,$(u.filename),1),l("div",zt,[k(L,{value:u.type,"onUpdate:value":G=>u.type=G,style:{width:"120px"},onChange:U},{default:_(()=>[k(F,{value:"drill"},{default:_(()=>t[26]||(t[26]=[S("Drill")])),_:1}),k(F,{value:"copper"},{default:_(()=>t[27]||(t[27]=[S("Copper")])),_:1}),k(F,{value:"silkscreen"},{default:_(()=>t[28]||(t[28]=[S("Silkscreen")])),_:1}),k(F,{value:"soldermask"},{default:_(()=>t[29]||(t[29]=[S("Soldermask")])),_:1}),k(F,{value:"ignore"},{default:_(()=>t[30]||(t[30]=[S("Ignore")])),_:1})]),_:2},1032,["value","onUpdate:value"]),u.type==="copper"||u.type==="soldermask"||u.type==="silkscreen"?(x(),C("div",Dt,[k(M,{type:u.side==="top"?"primary":"default",size:"small",onClick:G=>O(u,"top")},{default:_(()=>t[31]||(t[31]=[S(" Top ")])),_:2},1032,["type","onClick"]),k(M,{type:u.side==="bottom"?"primary":"default",size:"small",onClick:G=>O(u,"bottom")},{default:_(()=>t[32]||(t[32]=[S(" Bottom ")])),_:2},1032,["type","onClick"]),k(M,{type:u.side==="inner"?"primary":"default",size:"small",onClick:G=>O(u,"inner")},{default:_(()=>t[33]||(t[33]=[S(" Inner ")])),_:2},1032,["type","onClick"])])):A("",!0)])]))),128))]),l("div",Et,[k(M,{onClick:ve},{default:_(()=>t[34]||(t[34]=[S("Restore Default")])),_:1}),k(M,{type:"primary",onClick:he},{default:_(()=>t[35]||(t[35]=[S("Apply")])),_:1})])])]),_:1},8,["visible"])])}}});const Bt=pe(At,[["__scopeId","data-v-b2e0cc06"]]);window.process=Ce.exports;const me=Le(Bt);me.use(Se);me.mount("#app");
